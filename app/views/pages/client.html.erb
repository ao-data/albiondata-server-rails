<div class="page client-page">
  <header class="site-header">
    <div class="site-header__inner">
      <h1 class="site-title"><%= link_to "The Albion Online Data Project", root_path %></h1>
      <p class="site-tagline">Realtime market and gold data for Albion Online</p>
      <%= render "nav", current: :client %>
    </div>
  </header>

  <div class="disclaimer banner">
    <p><strong>These tools are not affiliated with Albion Online or Sandbox Interactive GmbH.</strong></p>
  </div>

  <main class="main-content">
    <h2 class="page-title">Client</h2>
    <p class="lead">The Albion Data client runs on your machine while you play Albion Online and uploads market and gold price data to the project.</p>

    <section class="content-section client-download-section">
      <h2>Get the client</h2>
      <p class="client-download-intro">Download the client and run it whenever you play. The client uploads market orders from the markets you open in game.</p>
      <div class="client-download-cta">
        <a href="https://github.com/ao-data/albiondata-client/releases" class="btn btn--primary" target="_blank" rel="noopener">Download the client</a>
      </div>
      <% if @client_download_stats && @client_download_stats.error.nil? %>
        <div class="client-stats">
          <p class="client-stats__intro">Live download stats from GitHub</p>
          <div class="client-stats__panels">
            <% if @client_download_stats.latest_release_tag.present? %>
              <div class="client-stats__panel">
                <h4 class="client-stats__panel-title">Latest release (<%= @client_download_stats.latest_release_tag %>)</h4>
                <p class="client-stats__panel-total"><%= number_with_delimiter(@client_download_stats.latest_release_downloads) %></p>
                <% if @client_download_stats.latest_downloads_by_os.present? %>
                  <div class="client-stats__row">
                    <span class="client-stats__label">Platform</span>
                    <span class="client-stats__pills">
                      <% %w[Windows macOS Linux Other].each do |key| %>
                        <% count = @client_download_stats.latest_downloads_by_os[key].to_i %>
                        <% if count > 0 %>
                          <span class="client-stats__pill"><%= key %> <%= number_with_delimiter(count) %></span>
                        <% end %>
                      <% end %>
                    </span>
                  </div>
                <% end %>
                <% if @client_download_stats.latest_downloads_by_type.present? %>
                  <div class="client-stats__row">
                    <span class="client-stats__label">Type</span>
                    <span class="client-stats__pills">
                      <% @client_download_stats.latest_downloads_by_type.sort_by { |_, v| -v }.each do |label, count| %>
                        <span class="client-stats__pill"><%= label %> <%= number_with_delimiter(count) %></span>
                      <% end %>
                    </span>
                  </div>
                <% end %>
              </div>
            <% end %>
            <div class="client-stats__panel">
              <h4 class="client-stats__panel-title">All releases</h4>
              <p class="client-stats__panel-total"><%= number_with_delimiter(@client_download_stats.total_downloads) %></p>
              <% if @client_download_stats.downloads_by_os.present? %>
                <div class="client-stats__row">
                  <span class="client-stats__label">Platform</span>
                  <span class="client-stats__pills">
                    <% %w[Windows macOS Linux Other].each do |key| %>
                      <% count = @client_download_stats.downloads_by_os[key].to_i %>
                      <% if count > 0 %>
                        <span class="client-stats__pill"><%= key %> <%= number_with_delimiter(count) %></span>
                      <% end %>
                    <% end %>
                  </span>
                </div>
              <% end %>
              <% if @client_download_stats.downloads_by_type.present? %>
                <div class="client-stats__row">
                  <span class="client-stats__label">Type</span>
                  <span class="client-stats__pills">
                    <% @client_download_stats.downloads_by_type.sort_by { |_, v| -v }.each do |label, count| %>
                      <span class="client-stats__pill"><%= label %> <%= number_with_delimiter(count) %></span>
                    <% end %>
                  </span>
                </div>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    </section>

    <section class="content-section">
      <h2>Command line options</h2>
      <p>To see all available command line parameters, launch the executable with <code>-h</code>, for example:</p>
      <p><code class="client-cmd">"C:\Program Files\Albion Data Client\albiondata-client.exe" -h</code></p>
      <p>Or add <code>-h</code> to your shortcut. Current options include:</p>
      <pre class="client-pre"><code>-d                    If specified no attempts will be made to upload data to remote server.
-debug                 Enable debug logging.
-events string         Whitelist of event IDs to output when debugging. Comma separated.
-events-ignore string  Blacklist of event IDs to hide when debugging. Comma separated.
-i string              Base URL to send PUBLIC data to ('nats://', 'http://' or 'noop', comma separated).
                       Default: http+pow://pow.west.albion-online-data.com or pow.east (by game server).
-ignore-decode-errors  Ignore decoding errors when debugging.
-l string              Listen on this comma-separated device list instead of all available.
-minimize              Automatically minimize the window.
-no-limit              Use all available CPU cores.
-o string              Parse a local file instead of checking Albion ports.
-operations string     Whitelist of operation IDs when debugging. Comma separated.
-operations-ignore string  Blacklist of operation IDs when debugging. Comma separated.
-output-file           Enable logging to file.
-p string              Base URL to send PRIVATE data to ('nats://', 'http://' or 'noop', comma separated).
-record string         Enable recording commands to a file for debugging.</code></pre>
    </section>
  </main>

  <footer class="site-footer">
    <p><%= link_to "The Albion Online Data Project", root_path %></p>
  </footer>
</div>
